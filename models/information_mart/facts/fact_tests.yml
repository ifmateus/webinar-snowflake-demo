models:
#### testing with dbt-expectations
  - name: fact_sales
    tests:
    - dbt_expectations.expect_table_row_count_to_equal_other_table:
          compare_model: ref('fact_sales_validate')
    columns:
      - name: 'customer_id'
        tests:
          - relationships:
              to: ref('dim_client')
              field: client_id
      - name: 'industry_id'
        tests:
          - relationship_except:
              to: ref('dim_industry')
              column_name: industry_id
              except: ['0']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: number
      - name: 'standard_cost'
        tests:
          - dbt_expectations.expect_column_max_to_be_between:
              max_value: 4000
              config:
                severity: warn
#### testing with dbt tests
      - name: 'customer_id'
        tests:
          - relationships:
              to: ref('dim_client')
              field: client_id
      - name: 'industry_id'
        tests:
          - relationship_except:
              to: ref('dim_industry')
              column_name: industry_id
              except: ['0']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: number
      - name: 'standard_cost'
        tests:
          - dbt_expectations.expect_column_max_to_be_between:
              max_value: 4000
              config:
                severity: warn